# =============================================================================
# cloudflared-lxc Environment - Example Variable Values
#
# Copy this file to terraform.tfvars and customize for your environment.
# DO NOT commit terraform.tfvars to version control (contains secrets).
#
# Usage:
#   cp terraform.tfvars.example terraform.tfvars
#   # Edit terraform.tfvars with your values
#   tofu init
#   tofu plan
#   tofu apply
#
# =============================================================================

# -----------------------------------------------------------------------------
# Proxmox Provider Configuration
#
# Alternatively, set via environment variables:
#   export PM_API_URL="https://10.0.10.2:8006/api2/json"
#   export PM_API_TOKEN_ID="root@pam!terraform"
#   export PM_API_TOKEN_SECRET="your-secret-here"
#
# WARNING: Never commit real credentials to version control!
# -----------------------------------------------------------------------------

pm_api_url          = "https://10.0.10.2:8006/api2/json"  # TODO: Update with your Proxmox URL
pm_api_token_id     = "root@pam!terraform"                 # TODO: Update with your token ID
# SECURITY: Set pm_api_token_secret via environment variable, not in this file!
# pm_api_token_secret = "DO_NOT_COMMIT_SECRETS"
pm_tls_insecure     = true

# -----------------------------------------------------------------------------
# Cloudflare Provider Configuration
#
# Alternatively, set via environment variables:
#   export CLOUDFLARE_API_TOKEN="your-api-token"
#
# Required API token permissions:
#   - Zone:DNS:Edit
#   - Account:Cloudflare Tunnel:Edit
#   - Account:Access: Apps and Policies:Edit (if using Access)
# -----------------------------------------------------------------------------

# SECURITY: Set cloudflare_api_token via environment variable!
# cloudflare_api_token = "DO_NOT_COMMIT_SECRETS"

cloudflare_account_id = "your-account-id"    # TODO: Find in Cloudflare dashboard
cloudflare_zone_id    = "your-zone-id"       # TODO: Zone ID for chriswagner.dev

# -----------------------------------------------------------------------------
# Proxmox Infrastructure
# -----------------------------------------------------------------------------

proxmox_node   = "pve"                                                        # TODO: Your Proxmox node name
storage_pool   = "local-lvm"                                                  # TODO: Your storage pool
network_bridge = "vmbr0"                                                      # TODO: Your network bridge
lxc_template   = "local:vztmpl/debian-12-standard_12.2-1_amd64.tar.zst"       # TODO: Your LXC template

# -----------------------------------------------------------------------------
# LXC Configuration
# -----------------------------------------------------------------------------

lxc_hostname  = "cloudflared"
lxc_vmid      = 0           # Set to 0 for auto-assign, or specify a VM ID
lxc_cores     = 1
lxc_memory    = 512         # MB
lxc_swap      = 256         # MB
lxc_disk_size = "4G"

# SECURITY: Set lxc_password via environment variable or in terraform.tfvars (not committed)
# lxc_password = "DO_NOT_COMMIT_SECRETS"

# Optional: SSH public key for root user
# lxc_ssh_public_key = "ssh-ed25519 AAAAC3NzaC1lZDI1NTE5... user@host"

# -----------------------------------------------------------------------------
# Network Configuration
# -----------------------------------------------------------------------------

# Option 1: Static IP (recommended for servers)
lxc_ip         = "10.0.10.10/24"   # TODO: Static IP for the LXC
lxc_gateway    = "10.0.10.1"       # TODO: Your gateway
lxc_nameserver = "1.1.1.1"         # Cloudflare DNS

# Option 2: DHCP
# lxc_ip = "dhcp"

# -----------------------------------------------------------------------------
# Cloudflare Tunnel Configuration
# -----------------------------------------------------------------------------

tunnel_name = "homelab-cloudflared"

# Generate tunnel secret with: openssl rand -base64 32
# SECURITY: Set tunnel_secret via environment variable or terraform.tfvars (not committed)
# tunnel_secret = "DO_NOT_COMMIT_SECRETS"

# -----------------------------------------------------------------------------
# DNS and Ingress Configuration
# -----------------------------------------------------------------------------

domain              = "chriswagner.dev"
proxmox_internal_ip = "10.0.10.2"   # TODO: Your Proxmox host internal IP

# Ingress rules for the tunnel
# Each rule creates a DNS record and tunnel route
ingress_rules = [
  {
    hostname      = "proxmox.chriswagner.dev"
    service       = "https://10.0.10.2:8006"
    no_tls_verify = true  # Required for self-signed Proxmox cert
  },
  # Add more services as needed:
  # {
  #   hostname      = "service.chriswagner.dev"
  #   service       = "http://10.0.10.x:port"
  #   no_tls_verify = false
  # },
]
