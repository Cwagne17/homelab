# =============================================================================
# AlmaLinux 9 Kickstart Configuration - MINIMAL VERSION
# =============================================================================

# Installation method
text
cdrom

# Accept EULA
eula --agreed

# Reboot after installation
reboot --eject

# Localization
lang en_US.UTF-8
keyboard us
timezone UTC --utc

# Network
network --bootproto=dhcp --device=link --onboot=yes --activate
network --hostname=packer-alma9

# Security
rootpw --plaintext packer
firewall --disabled
selinux --permissive
firstboot --disabled

# Partitioning
zerombr
clearpart --all --initlabel
autopart --type=lvm
bootloader --location=mbr

# Packages
%packages
@core
openssh-server
qemu-guest-agent
cloud-init
%end

# Post-install
%post
systemctl enable sshd
systemctl enable qemu-guest-agent
sed -i 's/^#PermitRootLogin.*/PermitRootLogin yes/' /etc/ssh/sshd_config
sed -i 's/^PasswordAuthentication.*/PasswordAuthentication yes/' /etc/ssh/sshd_config
%end
