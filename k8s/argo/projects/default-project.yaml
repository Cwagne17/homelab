# =============================================================================
# Default Argo CD Project
#
# This defines the default project that all applications use.
# Projects provide:
#   - Access control (which repos, clusters, namespaces are allowed)
#   - Resource limits
#   - Sync windows
#
# Refs: Req 5.2
# =============================================================================
---
apiVersion: argoproj.io/v1alpha1
kind: AppProject
metadata:
  name: default
  namespace: argocd
  labels:
    app.kubernetes.io/name: default-project
    app.kubernetes.io/part-of: homelab
  finalizers:
    - resources-finalizer.argocd.argoproj.io
spec:
  description: Default project for homelab applications

  # Source repositories allowed for applications in this project
  sourceRepos:
    # TODO: Update with your repository URL
    - https://github.com/cwagne17/homelab.git
    # Allow any repo (more permissive, use with caution)
    # - '*'

  # Destination clusters and namespaces allowed
  destinations:
    # Allow deployment to the local cluster, any namespace
    - namespace: '*'
      server: https://kubernetes.default.svc
      name: in-cluster

  # Cluster resources allowed to be managed
  clusterResourceWhitelist:
    - group: ''
      kind: Namespace
    - group: rbac.authorization.k8s.io
      kind: ClusterRole
    - group: rbac.authorization.k8s.io
      kind: ClusterRoleBinding
    - group: apiextensions.k8s.io
      kind: CustomResourceDefinition

  # Namespace-scoped resources allowed (all by default)
  namespaceResourceWhitelist:
    - group: '*'
      kind: '*'

  # Roles for this project (optional)
  # Uncomment to enable:
  # roles:
  #   - name: read-only
  #     description: Read-only access
  #     policies:
  #       - p, proj:default:read-only, applications, get, default/*, allow
  #     groups:
  #       - my-team

  # Sync windows (optional - for maintenance windows)
  # Uncomment to enable:
  # syncWindows:
  #   - kind: allow
  #     schedule: '0 22 * * *'
  #     duration: 2h
  #     applications:
  #       - '*'
